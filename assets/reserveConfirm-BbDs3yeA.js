import{_ as E,m as F,L as N,B as O,u as Q,d as H,e as T,i as s,t as a,q as d,F as j,E as P,C as U,D as z,z as i,H as A,M as J,J as g,N as K,O as L,p as V,j as $}from"./index-Bj6ZKCGR.js";const t=u=>(V("data-v-4d12b5dd"),u=u(),$(),u),G=t(()=>s("div",{class:"title"},"訂單資訊",-1)),W={class:"container"},X={class:"info"},Z=t(()=>s("div",{class:"block"},"房型",-1)),ss={class:"content"},os={class:"info"},ts=t(()=>s("div",{class:"block"},"入住日期",-1)),es={class:"content"},as={class:"info"},cs=t(()=>s("div",{class:"block"},"退房日期",-1)),ns={class:"content"},rs={class:"info"},ds=t(()=>s("div",{class:"block"},"入住天數",-1)),is={class:"content"},us={class:"info"},ls=t(()=>s("div",{class:"block"},"預訂間數",-1)),_s={class:"content"},ms={class:"info"},hs=t(()=>s("div",{class:"block"},"合計",-1)),fs={class:"content"},ps={__name:"reserveConfirm",setup(u){const e=F(),h=e.query.date1,f=e.query.date2,p=e.query.day,l=e.query.number,R=e.query.reservePrice,v=e.query.room,b=N(()=>new Intl.NumberFormat("en-US").format(R*p*l)),y=o=>i(o).format("YYYY/MM/DD"),k={經典雙人套房:"classicDoubleRoomCounts",經典四人套房:"classicQuadrupleRoomCounts",豪華雙人套房:"luxuryDoubleRoomCounts",豪華四人套房:"luxuryQuadrupleRoomCounts",山景雙人套房:"mountainDoubleRoomCounts",山景四人套房:"mountainQuadrupleRoomCounts",海景雙人套房:"oceanDoubleRoomCounts",海景四人套房:"oceanQuadrupleRoomCounts"},Y=(o,_)=>{const c=[],m=i(y(o)),n=i(y(_));let r=m;for(;r.isBefore(n,"day");)c.push(r.toDate()),r=r.add(1,"day");return c},M=O(),x=async()=>{const o=M.currentUser;if(!o)P.alert("請先登入會員","提示",{confirmButtonText:"OK",callback:()=>{D.push({path:"/member"})}});else{const _=k[v],c=U(g,"counts",_),m=await z(c);if(m.exists()){const n=m.data();Y(h,f).forEach(w=>{const C=i(w).format("YYYY-MM-DD");n[C]!==void 0&&(n[C]-=l)}),await A(c,n);const q=J(g,"users",o.uid,"userOrders"),B=i().format("YYYY-MM-DD HH:mm:ss"),I={room:v,date1:h,date2:f,day:p,number:l,total:b.value,orderDate:B};await K(q,I),D.push({path:"/info/list"}),L({message:"訂單已成功送出",type:"success",customClass:"custom-el-message"})}else console.error("錯誤：計數文檔不存在")}},D=Q();function S(){D.go(-1)}return(o,_)=>(H(),T(j,null,[G,s("div",W,[s("div",X,[Z,s("div",ss,a(d(v)),1)]),s("div",os,[ts,s("div",es,a(d(h)),1)]),s("div",as,[cs,s("div",ns,a(d(f)),1)]),s("div",rs,[ds,s("div",is,a(d(p))+"天",1)]),s("div",us,[ls,s("div",_s,a(d(l))+"間",1)]),s("div",ms,[hs,s("div",fs,"NT$"+a(b.value),1)]),s("div",{class:"confirm",onClick:x},"確認訂單"),s("div",{class:"confirm",onClick:S},"返回")])],64))}},bs=E(ps,[["__scopeId","data-v-4d12b5dd"]]);export{bs as default};
